import pandas as pd
import tkinter as tk
from tkinter import filedialog
from shapely.geometry import Polygon, Point
from shapely.geometry.polygon import orient

# Defina os polígonos em 3D (substitua pelos seus polígonos)
Beam_1 = orient(Polygon([(-32.42, -3.22, 0), (-31.75, -3.88, 0), (-32.42, -4.55, 0), (-33.08, -3.88, 0), (-32.42, -3.22, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_2 = orient(Polygon([(-44.22, -4.11, 0), (-45.15, -2.35, 0), (-44.25, -0.8, 0), (-40.75, -2.67, 0), (-42.08, -4.34, 0), (-44.22, -4.11, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_3 = orient(Polygon([(-42.08, -4.34, 0), (-40.75, -2.67, 0), (-39.39, -2.81, 0), (-37.15, -3.72, 0), (-38.83, -5.66, 0), (-41.34, -5.54, 0), (-42.08, -4.34, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_4 = orient(Polygon([(-38.83, -5.66, 0), (-37.15, -3.72, 0), (-34.78, -4.9, 0), (-34.18, -7.4, 0), (-36.22, -7.04, 0), (-38.06, -7.04, 0), (-38.83, -5.66, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_5 = orient(Polygon([(-45.15, -2.35, 0), (-44.22, -4.11, 0), (-45.24, -5.1, 0), (-45.58, -5.96, 0), (-46.3, -5.7, 0), (-47.36, -4.94, 0), (-47.84, -3.34, 0), (-46.80, -2.60, 0), (-45.15, -2.35, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_6 = orient(Polygon([(-45.58, -5.96, 0), (-45.24, -5.1, 0), (-44.22, -4.11, 0), (-42.08, -4.34, 0), (-41.34, -5.54, 0), (-42.21, -6.84, 0), (-44.29, -6.84, 0), (-44.85, -6.66, 0), (-45.35, -6.66, 0), (-45.58, -5.96, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_7 = orient(Polygon([(-41.34, -5.54, 0), (-38.83, -5.66, 0), (-38.06, -7.04, 0), (-39.2, -8.37, 0), (-41.49, -7.95, 0), (-42.21, -6.84, 0), (-41.34, -5.54, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_8 = orient(Polygon([(-38.06, -7.04, 0), (-36.22, -7.04, 0), (-34.18, -7.4, 0), (-35.5, -10.3, 0), (-38.62, -9.54, 0), (-39.2, -8.37, 0), (-38.06, -7.04, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_9 = orient(Polygon([(-45.35, -6.66, 0), (-44.85, -6.66, 0), (-44.29, -6.84, 0), (-42.21, -6.84, 0), (-41.49, -7.95, 0), (-41.7, -8.3, 0), (-42.55, -9.26, 0), (-44.43, -8.96, 0), (-45.16, -7.58, 0), (-45.35, -6.84, 0), (-45.35, -6.66, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
Beam_10 = orient(Polygon([(-42.55, -9.26, 0), (-41.7, -8.3, 0), (-41.49, -7.95, 0), (-39.2, -8.37, 0), (-38.62, -9.54, 0), (-39.58, -10.54, 0), (-41.90, -10.14, 0), (-42.55, -9.26, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 11
Beam_11 = orient(Polygon([(-35.5, -10.3, 0), (-35.34, -12.9, 0), (-38.63, -12.25, 0), (-39.58, -10.54, 0), (-38.62, -9.54, 0), (-35.5, -10.3, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 12
Beam_12 = orient(Polygon([(-45.35, -6.84, 0), (-45.16, -7.58, 0), (-44.43, -8.96, 0), (-46.04, -10.48, 0), (-46.89, -10.04, 0), (-47.7, -9.2, 0), (-48.05, -7.96, 0), (-47.7, -7.5, 0), (-46.7, -7.0, 0), (-45.35, -6.84, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 13
Beam_13 = orient(Polygon([(-46.04, -10.48, 0), (-44.43, -8.96, 0), (-42.55, -9.26, 0), (-41.90, -10.14, 0), (-42.3, -10.8, 0), (-42.7, -11.3, 0), (-43.06, -11.96, 0), (-44.56, -11.66, 0), (-45.12, -11.66, 0), (-45.84, -11.23, 0), (-46.04, -10.48, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 14
Beam_14 = orient(Polygon([(-41.90, -10.14, 0), (-39.58, -10.54, 0), (-38.63, -12.25, 0), (-39.45, -13.44, 0), (-42.15, -13.16, 0), (-42.8, -12.4, 0), (-43.06, -11.96, 0), (-42.7, -11.3, 0), (-42.3, -10.8, 0), (-41.90, -10.14, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 15
Beam_15 = orient(Polygon([(-39.45, -13.44, 0), (-38.63, -12.25, 0), (-35.34, -12.9, 0), (-35.2, -14.52, 0), (-38.51, -14.55, 0), (-39.45, -13.44, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 16
Beam_16 = orient(Polygon([(-45.84, -11.23, 0), (-45.12, -11.66, 0), (-44.56, -11.66, 0), (-43.06, -11.96, 0), (-42.8, -12.4, 0), (-42.15, -13.16, 0), (-42.5, -13.7, 0), (-42.77, -14.35, 0), (-44.36, -14.58, 0), (-46.54, -12.5, 0), (-45.84, -11.23, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 17
Beam_17 = orient(Polygon([(-42.15, -13.16, 0), (-39.45, -13.44, 0), (-38.51, -14.55, 0), (-39.18, -15.85, 0), (-39.9, -15.95, 0), (-41.01, -15.97, 0), (-41.9, -15.2, 0), (-42.77, -14.35, 0), (-42.5, -13.7, 0), (-42.15, -13.16, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 18
Beam_18 = orient(Polygon([(-39.18, -15.85, 0), (-38.51, -14.55, 0), (-35.2, -14.52, 0), (-35.25, -17.17, 0), (-37.85, -17.16, 0), (-39.18, -15.85, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 19
Beam_19 = orient(Polygon([(-51.06, -12.11, 0), (-49.0, -12.1, 0), (-47.81, -12.65, 0), (-48.21, -14.94, 0), (-50.54, -15.34, 0), (-51.29, -14.03, 0), (-51.06, -12.11, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 20
Beam_20 = orient(Polygon([(-45.07, -16.19, 0), (-46.93, -16.25, 0), (-48.21, -14.94, 0), (-47.81, -12.65, 0), (-46.54, -12.5, 0), (-44.36, -14.58,0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 21
Beam_21 = orient(Polygon([(-41.7, -17.23, 0), (-42.9, -17.25, 0), (-43.0, -17.35, 0), (-43.78, -17.35, 0), (-44.9, -16.25, 0), (-45.07, -16.19, 0), (-44.36, -14.58, 0), (-42.77, -14.35, 0), (-41.9, -15.2, 0), (-41.01, -15.97, 0), (-41.7, -17.23, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 22
Beam_22 = orient(Polygon([(-37.94, -18.5, 0), (-39.89, -18.65, 0), (-40.0, -18.65, 0), (-41.2, -17.55, 0), (-41.7, -17.23, 0), (-41.01, -15.97, 0), (-39.9, -15.95, 0), (-39.18, -15.85, 0), (-37.85, -17.16, 0), (-37.94, -18.5, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 23
Beam_23 = orient(Polygon([(-35.96, -20.2, 0), (-37.94, -18.5, 0), (-37.85, -17.16, 0), (-35.25, -17.17, 0), (-35.96, -20.2, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 24
Beam_24 = orient(Polygon([(-47.78, -17.55, 0), (-49.52, -17.33, 0), (-50.70, -16.05, 0), (-50.54, -15.34, 0), (-48.21, -14.94, 0), (-46.93, -16.25, 0), (-47.78, -17.55, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 25
Beam_25 = orient(Polygon([(-44.05, -19.05, 0), (-46.42, -19.15, 0), (-47.78, -17.55, 0), (-46.93, -16.25, 0), (-45.07, -16.19, 0), (-44.9, -16.25, 0), (-43.78, -17.35, 0), (-44.05, -19.05, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 26
Beam_26 = orient(Polygon([(-40.48, -20.31, 0), (-41.2, -20.4, 0), (-42.66, -20.45, 0), (-44.05, -19.05, 0), (-43.78, -17.35, 0), (-43.0, -17.35, 0), (-42.9, -17.25, 0), (-41.7, -17.23, 0), (-41.2, -17.55, 0), (-40.0, -18.65, 0), (-39.89, -18.65, 0), (-40.48, -20.31, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 27
Beam_27 = orient(Polygon([(-37.68, -22.16, 0), (-40.48, -20.31, 0), (-39.89, -18.65, 0), (-37.94, -18.5, 0), (-35.96, -20.2, 0), (-37.68, -22.16, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 28
Beam_28 = orient(Polygon([(-52.83, -18.95, 0), (-55.82, -18.86, 0), (-56.06, -18.3, 0), (-56.04, -17.15, 0), (-55.53, -16.03, 0), (-54.83, -15.52, 0), (-53.7, -15.8, 0), (-52.76, -16.36, 0), (-52.83, -18.95, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 29
Beam_29 = orient(Polygon([(-50.08, -19.59, 0), (-52.41, -19.4, 0), (-52.83, -18.95, 0), (-52.76, -16.36, 0), (-51.97, -16.1, 0), (-50.70, -16.05, 0), (-49.52, -17.33, 0), (-49.7, -18.5, 0), (-50.08, -19.59, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 30
Beam_30 = orient(Polygon([(-46.7, -20.45, 0), (-47.4, -20.45, 0), (-47.5, -20.55, 0), (-49.05, -20.55, 0), (-50.08, -19.59, 0), (-49.7, -18.5, 0), (-49.52, -17.33, 0), (-47.78, -17.55, 0), (-46.42, -19.15, 0), (-46.7, -20.45, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////

Beam_31 = orient(Polygon([(-43.05, -21.72, 0), (-45.36, -21.86, 0), (-46.55, -20.7, 0), (-46.7, -20.45, 0), (-46.42, -19.15, 0), (-44.05, -19.05, 0), (-42.66, -20.45, 0), (-43.05, -21.72, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 32
Beam_32 = orient(Polygon([(-41.64, -23.26, 0), (-43.05, -21.72, 0), (-42.66, -20.45, 0), (-41.2, -20.4, 0), (-40.48, -20.31, 0), (-37.68, -22.16, 0), (-41.64, -23.26, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 33
Beam_33 = orient(Polygon([(-52.95, -21.3, 0), (-54.71, -21.24, 0), (-55.97, -19.05, 0), (-55.82, -18.86, 0), (-52.83, -18.95, 0), (-52.41, -19.4, 0), (-52.95, -21.3, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 34
Beam_34 = orient(Polygon([(-49.13, -22.54, 0), (-50.27, -22.64, 0), (-51.65, -22.75, 0), (-52.95, -21.3, 0), (-52.41, -19.4, 0), (-50.08, -19.59, 0), (-49.05, -20.55, 0), (-49.13, -22.54, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 35
Beam_35 = orient(Polygon([(-45.46, -23.15, 0), (-45.7, -23.15, 0), (-45.8, -23.25, 0), (-46.7, -23.25, 0), (-46.8, -23.35, 0), (-48.04, -23.44, 0), (-49.13, -22.54, 0), (-49.05, -20.55, 0), (-47.5, -20.55, 0), (-47.4, -20.45, 0), (-46.7, -20.45, 0), (-46.55, -20.7, 0), (-45.36, -21.86, 0), (-45.46, -23.15, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 36
Beam_36 = orient(Polygon([(-41.53, -24.5, 0), (-44.5, -24.14, 0), (-45.46, -23.15, 0), (-45.36, -21.86, 0), (-43.05, -21.72, 0), (-41.64, -23.26, 0), (-41.53, -24.5, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 37
Beam_37 = orient(Polygon([(-40.09, -25.82, 0), (-41.53, -24.5, 0), (-41.64, -23.26, 0), (-37.68, -22.16, 0), (-40.09, -25.82, 0)]))#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 38
Beam_38 = orient(Polygon([(-55.83, -22.89, 0), (-58.06, -22.17, 0), (-58.39, -20.19, 0), (-57.95, -19.20, 0), (-55.97, -19.05, 0), (-54.71, -21.24, 0), (-55.83, -22.89, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 39
Beam_39 = orient(Polygon([(-51.73, -24.11, 0), (-54.47, -24.71, 0), (-55.53, -23.99, 0), (-55.83, -22.89, 0), (-54.71, -21.24, 0), (-52.95, -21.3, 0), (-51.65, -22.75, 0), (-51.73, -24.11, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 40
Beam_40 = orient(Polygon([(-47.95, -25.44, 0), (-48.97, -25.65, 0), (-50.05, -25.82, 0), (-51.73, -24.11, 0), (-51.65, -22.75, 0), (-50.27, -22.64, 0), (-49.13, -22.54, 0), (-48.04, -23.44, 0), (-47.95, -23.7, 0), (-47.95, -25.44, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 41
Beam_41 = orient(Polygon([(-44.47, -27.23, 0), (-47.95, -25.44, 0), (-47.95, -23.7, 0), (-48.04, -23.44, 0), (-46.8, -23.35, 0), (-46.7, -23.25, 0), (-45.8, -23.25, 0), (-45.7, -23.15, 0), (-45.46, -23.15, 0), (-44.5, -24.14, 0), (-44.47, -27.23, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 42
Beam_42 = orient(Polygon([(-40.09, -25.82, 0), (-44.47, -27.23, 0), (-44.5, -24.14, 0), (-41.53, -24.5, 0), (-40.09, -25.82, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 43
Beam_43 = orient(Polygon([(-50.1, -27.26, 0), (-52.04, -27.61, 0), (-53.81, -26.34, 0), (-54.71, -25.64, 0), (-54.47, -24.71, 0), (-51.73, -24.11, 0), (-50.05, -25.82, 0), (-50.1, -27.26, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 44
Beam_44 = orient(Polygon([(-48.35, -28.58, 0), (-50.1, -27.26, 0), (-50.05, -25.82, 0), (-48.97, -25.65, 0), (-47.95, -25.44, 0), (-48.35, -28.58, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 45
Beam_45 = orient(Polygon([(-52.06, -29.97, 0), (-52.4, -29.97, 0), (-52.5, -30.04, 0), (-54.11, -30.04, 0), (-55.52, -27.93, 0), (-53.81, -26.34, 0), (-52.04, -27.61, 0), (-52.06, -29.97, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 46
Beam_46 = orient(Polygon([(-50.32, -31.54, 0), (-51.4, -30.64, 0), (-52.06, -29.97, 0), (-52.04, -27.61, 0), (-50.1, -27.26, 0), (-48.35, -28.58, 0), (-50.32, -31.54, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 47
Beam_47 = orient(Polygon([(-55.28, -31.63, 0), (-58.08, -30.13, 0), (-55.52, -27.93, 0), (-54.11, -30.04, 0), (-55.28, -31.63, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 48
Beam_48 = orient(Polygon([(-53.22, -34.25, 0), (-55.28, -31.63, 0), (-54.11, -30.04, 0), (-52.5, -30.04, 0), (-52.4, -29.97, 0), (-52.06, -29.97, 0), (-51.4, -30.64, 0), (-50.32, -31.54, 0), (-53.22, -34.25, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 49
Beam_49 = orient(Polygon([(-51.10, -0.90, 0), (-52.64, -1.44, 0), (-54.22, -1.42, 0), (-56.06, 2.63, 0), (-51.21, 4.98, 0), (-49.26, 1.73, 0), (-50.42, 0.63, 0), (-51.10, -0.90, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 50
Beam_50 = orient(Polygon([(-49.83, -3.31, 0), (-51.10, -0.90, 0), (-50.42, 0.63, 0), (-49.26, 1.73, 0), (-44.25, -0.8, 0), (-45.15, -2.35, 0), (-46.80, -2.60, 0), (-47.84, -3.34, 0), (-49.83, -3.31, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 51
Beam_51 = orient(Polygon([(-59.16, 2.17, 0), (-60.05, 1.25, 0), (-60.46, -0.23, 0), (-61.52, -0.80, 0), (-63.60, -0.80, 0), (-64.5, 1.41, 0), (-64.95, 4.42, 0), (-59.04, 6.18, 0), (-59.16, 2.17, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 52
Beam_52 = orient(Polygon([(-55.95, -2.66, 0), (-57.38, -2.1, 0), (-59.42, -2.22, 0), (-60.46, -0.23, 0), (-60.05, 1.25, 0), (-59.16, 2.17, 0), (-56.06, 2.63, 0), (-54.22, -1.42, 0), (-55.08, -2.19, 0), (-55.95, -2.66, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 53
Beam_53 = orient(Polygon([(-51.70, -5.77, 0), (-55.28, -5.74, 0), (-55.8, -4.58, 0), (-55.95, -2.66, 0), (-55.08, -2.19, 0), (-54.22, -1.42, 0), (-52.64, -1.44, 0), (-51.10, -0.90, 0), (-49.83, -3.31, 0), (-51.06, -4.54, 0), (-51.70, -5.77, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 54
Beam_54 = orient(Polygon([(-50.79, -7.73, 0), (-51.4, -6.7, 0), (-51.70, -5.77, 0), (-51.06, -4.54, 0), (-49.83, -3.31, 0), (-47.84, -3.34, 0), (-47.36, -4.94, 0), (-46.3, -5.7, 0), (-45.58, -5.96, 0), (-45.35, -6.66, 0), (-45.35, -6.84, 0), (-46.7, -7.0, 0), (-47.7, -7.5, 0), (-48.05, -7.96, 0), (-50.79, -7.73, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 55
Beam_55 = orient(Polygon([(-65.43, -2.35, 0), (-67.61, -1.7, 0), (-70.44, -2.45, 0), (-70.03, 1.88, 0), (-67.38, 2.44, 0), (-64.5, 1.41, 0), (-63.60, -0.80, 0), (-64.43, -1.62, 0), (-65.43, -2.35, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 56
Beam_56 = orient(Polygon([(-60.95, -4.91, 0), (-62.91, -5.44, 0), (-64.71, -5.23, 0), (-65.2, -4.59, 0), (-65.43, -2.35, 0), (-64.43, -1.62, 0), (-63.60, -0.80, 0), (-61.52, -0.80, 0), (-60.46, -0.23, 0), (-59.42, -2.22, 0), (-60.3, -3.4, 0), (-60.95, -4.91, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 57
Beam_57 = orient(Polygon([(-56.51, -8.13, 0), (-59.38, -8.25, 0), (-60.24, -5.86, 0), (-60.95, -4.91, 0), (-60.3, -3.4, 0), (-59.42, -2.22, 0), (-57.38, -2.1, 0), (-55.95, -2.66, 0), (-55.8, -4.58, 0), (-55.28, -5.74, 0), (-55.75, -6.3, 0), (-56.51, -8.13, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 58
Beam_58 = orient(Polygon([(-52.16, -11.09, 0), (-53.31, -10.85, 0), (-54.29, -10.89, 0), (-56.51, -8.13, 0), (-55.75, -6.3, 0), (-55.28, -5.74, 0), (-51.70, -5.77, 0), (-51.4, -6.7, 0), (-50.79, -7.73, 0), (-51.55, -8.8, 0), (-52.15, -10.12, 0), (-52.16, -11.09, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 59
Beam_59 = orient(Polygon([(-48.05, -7.96, 0), (-47.7, -9.2, 0), (-46.89, -10.04, 0), (-46.04, -10.48, 0), (-45.84, -11.23, 0), (-46.54, -12.5, 0), (-47.81, -12.65, 0), (-49.0, -12.1, 0), (-51.06, -12.11, 0), (-52.16, -11.09, 0), (-52.15, -10.12, 0), (-51.55, -8.8, 0), (-50.79, -7.73, 0), (-48.05, -7.96, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 60
Beam_60 = orient(Polygon([(-65.45, -7.51, 0), (-67.4, -8.35, 0), (-68.53, -8.35, 0), (-68.90, -6.40, 0), (-69.7, -5.44, 0), (-70.6, -5.06, 0), (-71.13, -4.15, 0), (-70.44, -2.45, 0), (-67.61, -1.7, 0), (-65.43, -2.35, 0), (-65.2, -4.59, 0), (-64.71, -5.23, 0), (-65.25, -6.08, 0), (-65.45, -7.51, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 61
Beam_61 = orient(Polygon([(-60.44, -9.35, 0), (-62.06, -9.00, 0), (-64.25, -9.43, 0), (-65.45, -7.51, 0), (-65.25, -6.08, 0), (-64.71, -5.23, 0), (-62.91, -5.44, 0), (-60.95, -4.91, 0), (-60.24, -5.86, 0), (-59.38, -8.25, 0), (-60.44, -9.35, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 62
Beam_62 = orient(Polygon([(-56.29, -13.58, 0), (-59.04, -13.52, 0), (-59.86, -12.51, 0), (-60.44, -9.35, 0), (-59.38, -8.25, 0), (-56.51, -8.13, 0), (-54.29, -10.89, 0), (-54.6, -11.05, 0), (-55.65, -12.1, 0), (-56.29, -13.58, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 63
Beam_63 = orient(Polygon([(-54.29, -10.89, 0), (-53.31, -10.85, 0), (-52.16, -11.09, 0), (-51.06, -12.11, 0), (-51.29, -14.03, 0), (-50.54, -15.34, 0), (-50.70, -16.05, 0), (-51.97, -16.10, 0), (-52.76, -16.36, 0), (-53.70, -15.80, 0), (-54.83, -15.52, 0), (-56.29, -13.58, 0), (-55.65, -12.10, 0), (-54.60, -11.05, 0), (-54.29, -10.89, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 64
Beam_64 = orient(Polygon([(-70.36, -9.68, 0), (-70.72, -10.92, 0), (-75.23, -8.13, 0), (-73.32, -4.81, 0), (-71.13, -4.15, 0), (-70.60, -5.06, 0), (-69.70, -5.44, 0), (-68.90, -6.40, 0), (-68.53, -8.35, 0), (-70.36, -9.68, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 65
Beam_65 = orient(Polygon([(-65.59, -12.14, 0), (-70.72, -10.92, 0), (-70.36, -9.68, 0), (-68.53, -8.35, 0), (-67.40, -8.35, 0), (-65.45, -7.51, 0), (-64.25, -9.43, 0), (-65.59, -12.14, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 66
Beam_66 = orient(Polygon([(-60.86, -16.15, 0), (-65.59, -12.14, 0), (-64.25, -9.43, 0), (-62.06, -9.00, 0), (-60.44, -9.35, 0), (-59.86, -12.51, 0), (-59.04, -13.52, 0), (-60.86, -16.15, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////
# Coordenadas dos pontos para o polígono 67
Beam_67 = orient(Polygon([(-59.8, -17.68, 0), (-60.86, -16.15, 0), (-59.04, -13.52, 0), (-56.29, -13.58, 0), (-54.83, -15.52, 0), (-55.53, -16.03, 0), (-56.04, -17.15, 0), (-56.06, -18.3, 0), (-55.82, -18.86, 0), (-55.97, -19.05, 0), (-57.95, -19.20, 0), (-59.8, -17.68, 0)]))
#===============================///==================///=================///=================///=================///==================///==================///===================///=============///================///========///=================///===================///==========///=================///========///===================///===========////

Beams = [Beam_1, Beam_2, Beam_3, Beam_4, Beam_5, Beam_6, Beam_7, Beam_8, Beam_9, Beam_10, 
         Beam_11, Beam_12, Beam_13, Beam_14, Beam_15, Beam_16, Beam_17, Beam_18, Beam_19, Beam_20,
         Beam_21, Beam_22, Beam_23, Beam_24, Beam_25, Beam_26, Beam_27, Beam_28, Beam_29, Beam_30, 
         Beam_31, Beam_32, Beam_33, Beam_34, Beam_35, Beam_36, Beam_37, Beam_38, Beam_39, Beam_40, 
         Beam_41, Beam_42, Beam_43, Beam_44, Beam_45, Beam_46, Beam_47, Beam_48, Beam_49, Beam_50, 
         Beam_51, Beam_52, Beam_53, Beam_54, Beam_55, Beam_56, Beam_57, Beam_58, Beam_59, Beam_60, 
         Beam_61, Beam_62, Beam_63, Beam_64, Beam_65, Beam_66, Beam_67]


def verificar_coordenada(coord):
    x, y = coord
    ponto = Point(float(x), float(y), 0)
    indice_Beam_ = next((i + 1 for i, Beam_ in enumerate(Beams) if ponto.within(Beam_)), None)
    print(f"Coordenada {coord} está no Beam {indice_Beam_}")
    return indice_Beam_
# Função para processar a entrada de coordenadas
def processar_coordenadas():
    coordenadas = entrada.get().split(",")
    if len(coordenadas) == 2:
        try:
            x, y = map(float, coordenadas)
            indice_Beam_ = verificar_coordenada((x, y))
            if indice_Beam_ is not None:
                resultado.config(text=f"A coordenada está dentro do Polígono {indice_Beam_}.")
            else:
                resultado.config(text="A coordenada não está dentro de nenhum polígono.")
        except ValueError:
            resultado.config(text="Coordenadas inválidas. Use formato x,y.")
    else:
        resultado.config(text="Coordenadas inválidas. Use formato x,y.")
        
def abrir_arquivo_excel():
    caminho_arquivo = filedialog.askopenfilename(title="Selecione um arquivo Excel", filetypes=[("Arquivos Excel", "*.xlsx; *.xls")])
    if caminho_arquivo:
        try:
            df = pd.read_excel(caminho_arquivo)  # Lê o arquivo Excel
            processar_coordenadas_excel(df)  # Chama a função para processar as coordenadas
        except pd.errors.EmptyDataError:
            resultado.config(text="O arquivo Excel está vazio.")
        except Exception as e:
            resultado.config(text=f"Erro ao abrir o arquivo Excel: {str(e)}")

# Função para processar coordenadas de um DataFrame
def processar_coordenadas_excel(df):
    try:
        # Verifica se as colunas 'Longitude (°)' e 'Latitude (°)' existem no DataFrame
        if 'Longitude (°)' in df.columns and 'Latitude (°)' in df.columns:
            # Adiciona uma nova coluna 'Beam' ao DataFrame com o resultado da verificação
            df['Beam'] = df.apply(lambda row: verificar_coordenada((row['Longitude (°)'], row['Latitude (°)'])), axis=1)

        # Obtém o caminho do novo arquivo com um sufixo "_resultados"
        caminho_novo_arquivo = filedialog.asksaveasfilename(defaultextension=".xlsx", filetypes=[("Arquivos Excel", "*.xlsx")])
        if caminho_novo_arquivo:
            caminho_novo_arquivo = caminho_novo_arquivo.replace('.xlsx', '_resultados.xlsx')  # Adiciona um sufixo ao nome do arquivo
            df.to_excel(caminho_novo_arquivo, index=False)
            resultado.config(text=f"Resultados salvos em: {caminho_novo_arquivo}")
        else:
            resultado.config(text="Operação cancelada.")
    except Exception as e:
        resultado.config(text=f"Erro ao processar as coordenadas do arquivo Excel: {str(e)}")

        
# Crie a janela da interface gráfica
janela = tk.Tk()
janela.title("Verificador de Polígonos")

# Crie uma entrada para as coordenadas
entrada_label = tk.Label(janela, text="Digite as coordenadas (x,y):")
entrada_label.pack()
entrada = tk.Entry(janela)
entrada.pack()

# Adicione um botão para abrir o arquivo Excel
abrir_arquivo_botao = tk.Button(janela, text="Abrir Arquivo Excel", command=abrir_arquivo_excel)
abrir_arquivo_botao.pack()

# Crie um botão para processar as coordenadas
processar_botao = tk.Button(janela, text="Processar", command=processar_coordenadas)
processar_botao.pack()

# Crie um rótulo para exibir o resultado
resultado = tk.Label(janela, text="")
resultado.pack()

# Inicie a interface gráfica
janela.mainloop()
